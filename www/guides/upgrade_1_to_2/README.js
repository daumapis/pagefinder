Ext.data.JsonP.upgrade_1_to_2({"guide":"<h1 id='upgrade_1_to_2-section-upgrading-from-sencha-touch-1-x-to-2-x'>Upgrading from Sencha Touch 1.x to 2.x</h1>\n<div class='toc'>\n<p><strong>Contents</strong></p>\n<ol>\n<li><a href='#!/guide/upgrade_1_to_2-section-class-system'>Class System</a></li>\n<li><a href='#!/guide/upgrade_1_to_2-section-mvc-migration'>MVC Migration</a></li>\n<li><a href='#!/guide/upgrade_1_to_2-section-further-help'>Further Help</a></li>\n</ol>\n</div>\n\n<p>Sencha Touch 2 brings a number of refinements to the framework. Since some of these changes require you to update parts of your application's code, this guide takes you through the changes you will need to make.</p>\n\n<p>In addition to the guide, Sencha Touch 2 comes with a backwards-compatibility build that makes the migration process easier. <strong>Note that this build does not automatically guarantee that your 1.x app works out of the box</strong>. Wherever possible, the compatibility build figures out what your 1.x app code is trying to do and route it through to the 2.x API. Whenever it does this, the compatibility build logs a warning to the console indicating the items that you need to update.</p>\n\n<p>If you follow the steps below and then correct any warnings the compatibility layer informs you about, you should obtain an application that runs on Sencha Touch 2.x.</p>\n\n<p><a href=\"#!/video/migrating-from-1-to-2\">See the Migrating from Touch 1.x to 2.0 Video from SenchaCon 2011</a></p>\n\n<h2 id='upgrade_1_to_2-section-class-system'>Class System</h2>\n\n<p>When migrating your app, the biggest change required is related to the way in which classes are defined. Sencha Touch 2 uses the upgraded class system derived from Ext JS 4, which brings powerful new capabilities such as mixins, dynamic loading, and the config system.</p>\n\n<p>In Sencha Touch 1.x, there were two main ways of defining classes - using <a href=\"#!/api/Ext-method-extend\" rel=\"Ext-method-extend\" class=\"docClass\">Ext.extend</a> and using one of the MVC-specific convenience functions, such as regModel and regController. In Sencha Touch 2, all classes are defined the same way, using the <a href=\"#!/api/Ext-method-define\" rel=\"Ext-method-define\" class=\"docClass\">Ext.define</a> method. Let us consider the following 1.x example class and see how we could migrate it to the 2.x framework:</p>\n\n<pre><code>Geo.views.BillSummary = <a href=\"#!/api/Ext-method-extend\" rel=\"Ext-method-extend\" class=\"docClass\">Ext.extend</a>(<a href=\"#!/api/Ext.Panel\" rel=\"Ext.Panel\" class=\"docClass\">Ext.Panel</a>, {\n    scroll: 'vertical',\n    html: \"Loading...\",\n    styleHtmlContent: true,\n    initComponent: function() {\n        this.tpl = <a href=\"#!/api/Ext.XTemplate-static-method-from\" rel=\"Ext.XTemplate-static-method-from\" class=\"docClass\">Ext.XTemplate.from</a>('billsummary');\n        Geo.views.BillSummary.superclass.initComponent.call(this);\n    },\n\n    /**\n     * Get the billSummary and update the contents of the panel.\n     */\n    getBill: function(bill) {\n        Geo.CongressService.getBillSummary({\n            bill: bill\n        }, this.onBillSummaryResponse, this);\n    },\n\n    // private\n    onBillSummaryResponse: function(billSummary) {\n        if (<a href=\"#!/api/Ext-method-isArray\" rel=\"Ext-method-isArray\" class=\"docClass\">Ext.isArray</a>(billSummary.Paragraph)) {\n            this.update(billSummary);\n        } else {\n            this.update('No Bill Summary Available');\n        }\n\n    }\n});\n</code></pre>\n\n<p>In Sencha Touch 2.x, the previous code is written as follows:</p>\n\n<pre><code><a href=\"#!/api/Ext-method-define\" rel=\"Ext-method-define\" class=\"docClass\">Ext.define</a>('Geo.view.BillSummary', {\n    extend: '<a href=\"#!/api/Ext.Panel\" rel=\"Ext.Panel\" class=\"docClass\">Ext.Panel</a>',\n\n    config: {\n        scroll: 'vertical',\n        html: 'Loading...',\n        styleHtmlContent: true\n    },\n\n    initialize: function() {\n        this.callParent(arguments);\n\n        this.tpl = <a href=\"#!/api/Ext.Template-static-method-from\" rel=\"Ext.Template-static-method-from\" class=\"docClass\">Ext.Template.from</a>('billsummary');\n    },\n\n    /**\n     * Get the billSummary and update the contents of the panel.\n     */\n    getBill: function(bill) {\n        Geo.CongressService.getBillSummary({\n            bill: bill\n        }, this.onBillSummaryResponse, this);\n    },\n\n    // private\n    onBillSummaryResponse: function(billSummary) {\n        if (<a href=\"#!/api/Ext-method-isArray\" rel=\"Ext-method-isArray\" class=\"docClass\">Ext.isArray</a>(billSummary.Paragraph)) {\n            this.setHtml(billSummary);\n        } else {\n            this.setHtml('No Bill Summary Available');\n        }\n    }\n});\n</code></pre>\n\n<p>The first thing to note is that we have swapped out <a href=\"#!/api/Ext-method-extend\" rel=\"Ext-method-extend\" class=\"docClass\">Ext.extend</a> for <a href=\"#!/api/Ext-method-define\" rel=\"Ext-method-define\" class=\"docClass\">Ext.define</a>. All of the old constituent parts are still present, but we have shuffled them around to use the new syntax. You can note that in version 2.x all of the class names are string based. This enables the dynamic loading system to automatically load these classes onto the page, if they are not already present. See the <a href=\"#!/guide/class_system\">class system guide</a> for more details.</p>\n\n<p>Another change relates to moving all of the configuration options into a config object. The configuration options for each class can be found in the class documentation. When defining a class, any parameter found in the configuration section of the class should be placed into a config object.</p>\n\n<p>The config system provides some key benefits, primarily a guarantee of the API's consistency. For example, the <a href=\"#!/api/Ext.Panel-cfg-html\" rel=\"Ext.Panel-cfg-html\" class=\"docClass\">html</a> config option guarantees that we can call <a href=\"#!/api/Ext.Panel-method-getHtml\" rel=\"Ext.Panel-method-getHtml\" class=\"docClass\">getHtml</a> and <a href=\"#!/api/Ext.Panel-method-setHtml\" rel=\"Ext.Panel-method-setHtml\" class=\"docClass\">setHtml</a> at any time, removing the guesswork from figuring out which functions to call. Every single config option has getter and setter functions that follow the same pattern as getHtml and setHtml. We use this to our advantage in the onBillSummaryResponse function, where we replaced the old 'update' function with the clearer <a href=\"#!/api/Ext.Panel-method-setHtml\" rel=\"Ext.Panel-method-setHtml\" class=\"docClass\">setHtml</a> function.</p>\n\n<p>Finally, we replaced initComponent with initialize. In version 1.x of the framework, initComponent was only available on Component classes, which excluded all the other classes, such as Models, Controllers and utilities. In version 2.x, every class has an initialize function that you can implement if you want some logic to be performed on instantiation. Another detail to note here is that you no longer need the long <em>Geo.views.BillSummary.superclass.initComponent.call(this);</em> call - you can instead always use <em>this.callParent(arguments)</em> to call the superclass function.</p>\n\n<h2 id='upgrade_1_to_2-section-mvc-migration'>MVC Migration</h2>\n\n<p>The MVC architecture in Sencha Touch 2 is a refinement of the approach taken in Sencha Touch 1. Although most of the concepts are the same, the syntax has been improved to make the API more expressive, and to make your code more readable and testable.</p>\n\n<h3 id='upgrade_1_to_2-section-models'>Models</h3>\n\n<p>Similar to all other classes in Sencha Touch 2, the Model classes and the rest of the data package now expect their configurations to be placed into a config block. Sencha Touch 2 also unifies the way you define all of your application's classes: <a href=\"#!/api/Ext-method-regModel\" rel=\"Ext-method-regModel\" class=\"docClass\">Ext.regModel</a> is no longer needed - instead a Model is just <a href=\"#!/api/Ext-method-define\" rel=\"Ext-method-define\" class=\"docClass\">defined</a> like any other class. Migrating your Models is very simple - considering you once had a Model like in the following code sample:</p>\n\n<pre><code><a href=\"#!/api/Ext-method-regModel\" rel=\"Ext-method-regModel\" class=\"docClass\">Ext.regModel</a>('MyApp.model.User', {\n    fields: [\n        {name: 'name',  type: 'string'},\n        {name: 'age',   type: 'int'},\n        {name: 'alive', type: 'boolean', defaultValue: true}\n    ],\n\n    validations: [\n        {type: 'presence', field: 'age'},\n        {type: 'length',   field: 'name', min: 2}\n    ],\n\n    sayName: function() {\n        alert(this.get('name'));\n    }\n});\n</code></pre>\n\n<p>In Sencha Touch 2 the same Model would look like the following:</p>\n\n<pre><code><a href=\"#!/api/Ext-method-define\" rel=\"Ext-method-define\" class=\"docClass\">Ext.define</a>('MyApp.model.User', {\n    extend: '<a href=\"#!/api/Ext.data.Model\" rel=\"Ext.data.Model\" class=\"docClass\">Ext.data.Model</a>',\n\n    config: {\n        fields: [\n            {name: 'name',  type: 'string'},\n            {name: 'age',   type: 'int'},\n            {name: 'alive', type: 'boolean', defaultValue: true}\n        ],\n\n        validations: [\n            {type: 'presence', field: 'age'},\n            {type: 'length',   field: 'name', min: 2}\n        ]\n    },\n\n    sayName: function() {\n        alert(this.get('name'));\n    }\n});\n</code></pre>\n\n<p>A Model migration is generally done in four steps:</p>\n\n<ol>\n<li>Replace <a href=\"#!/api/Ext-method-regModel\" rel=\"Ext-method-regModel\" class=\"docClass\">Ext.regModel</a> with <a href=\"#!/api/Ext-method-define\" rel=\"Ext-method-define\" class=\"docClass\">Ext.define</a></li>\n<li>Create a new Model class by extending <a href=\"#!/api/Ext.data.Model\" rel=\"Ext.data.Model\" class=\"docClass\">Ext.data.Model</a></li>\n<li>Move all of your Model's configurations into its config block</li>\n<li>Leave any custom functions (for example sayName in the previous code) outside of the config block</li>\n</ol>\n\n\n<h3 id='upgrade_1_to_2-section-views'>Views</h3>\n\n<p>Aside from migrating to the new class system syntax, view migration is quite simple. The main point to keep in mind is the convention regarding view class names. In Sencha Touch 2 and onward we recommend that your view class names follow the pattern MyApp.view.SomeViewName. Note that the 'view' is singular, which enables the class system to automatically load the view class from the file app/view/SomeViewName.js.</p>\n\n<h3 id='upgrade_1_to_2-section-application'>Application</h3>\n\n<p>When it comes to the <a href=\"#!/api/Ext-method-application\" rel=\"Ext-method-application\" class=\"docClass\">Ext.application</a> definition, you can keep most of the syntax from your 1.x app:</p>\n\n<pre><code><a href=\"#!/api/Ext-method-application\" rel=\"Ext-method-application\" class=\"docClass\">Ext.application</a>({\n    name: 'MyApp',\n\n    icon: 'resources/images/logo.png',\n\n    launch: function() {\n        <a href=\"#!/api/Ext-method-create\" rel=\"Ext-method-create\" class=\"docClass\">Ext.create</a>('MyApp.view.Main');\n    }\n});\n</code></pre>\n\n<p>The only change is that we use <a href=\"#!/api/Ext-method-create\" rel=\"Ext-method-create\" class=\"docClass\">Ext.create</a> to instantiate MyApp.view.Main, which is our app's main screen.</p>\n\n<p>In addition to this change, there is another slight change in approach when it comes to loading the models, views, controllers, and stores your application needs. In 1.x, it was common to define all of your controllers inside the <a href=\"#!/api/Ext-method-application\" rel=\"Ext-method-application\" class=\"docClass\">Ext.application</a> block, along with <em>some</em> of your models, views and stores. The rest of the dependencies could be scattered throughout your application, making it difficult to easily understand exactly what the app is composed of.</p>\n\n<p>In Sencha Touch 2 we encourage you to define all of your application's dependencies inside the <a href=\"#!/api/Ext-method-application\" rel=\"Ext-method-application\" class=\"docClass\">Ext.application</a> block, instead of placing some of them inside Controllers. An example might look like this:</p>\n\n<pre><code><a href=\"#!/api/Ext-method-application\" rel=\"Ext-method-application\" class=\"docClass\">Ext.application</a>({\n    name: 'MyApp',\n\n    icon: 'resources/images/logo.png',\n\n    models: ['User', 'Group'],\n    controllers: ['Users', 'Login'],\n    views: ['Main', 'Users'],\n    stores: ['Users'],\n\n    launch: function() {\n        <a href=\"#!/api/Ext-method-create\" rel=\"Ext-method-create\" class=\"docClass\">Ext.create</a>('MyApp.view.Main');\n    }\n});\n</code></pre>\n\n<h3 id='upgrade_1_to_2-section-controllers'>Controllers</h3>\n\n<p>Similar to Model, Sencha Touch 2 expects any Controller to be defined like any other class, so the <a href=\"#!/api/Ext-method-regController\" rel=\"Ext-method-regController\" class=\"docClass\">Ext.regController</a> function is deprecated. In version 1.x we might have a controller such as the following:</p>\n\n<pre><code><a href=\"#!/api/Ext-method-regController\" rel=\"Ext-method-regController\" class=\"docClass\">Ext.regController</a>(\"searches\", {\n    showSomething: function() {\n        alert('something');\n    }\n});\n</code></pre>\n\n<p>which in version 2.x becomes as shown in the following sample code:</p>\n\n<pre><code><a href=\"#!/api/Ext-method-define\" rel=\"Ext-method-define\" class=\"docClass\">Ext.define</a>('MyApp.controller.Searches', {\n    extend: '<a href=\"#!/api/Ext.app.Controller\" rel=\"Ext.app.Controller\" class=\"docClass\">Ext.app.Controller</a>',\n\n    showSomething: function() {\n        alert('something');\n    }\n});\n</code></pre>\n\n<p>As mentioned previously, if your 1.x controller defines additional model, view or store dependencies, you should move these into the Application instead. The compatibility build will still attempt to load those dependencies, but the non-compat build will not.</p>\n\n<h4 id='upgrade_1_to_2-section-routes'>Routes</h4>\n\n<p>In Sencha Touch 1.x, a Controller was largely a collection of functions that could be dispatched to externally. Often this would mean that an Application would call <a href=\"#!/api/Ext-method-dispatch\" rel=\"Ext-method-dispatch\" class=\"docClass\">Ext.dispatch</a>, specifying the Controller name, which function to call and which arguments to pass to the function. Other times, the dispatching would be automatic, triggered by a change in the url picked up by the Router.</p>\n\n<p>In 2.x, the Controller becomes a lot more proactive, actively registering inside its config block routes that it cares about:</p>\n\n<pre><code><a href=\"#!/api/Ext-method-define\" rel=\"Ext-method-define\" class=\"docClass\">Ext.define</a>('MyApp.controller.Searches', {\n    config: {\n        routes: {\n            'search/:query': 'doSearch'\n        }\n    },\n\n    doSearch: function(query) {\n        alert('searching for ' + query);\n    }\n});\n</code></pre>\n\n<p>This bypasses the need for a separate routes file and allows the Controller to indicate that whenever the page URL matches 'search/:query', the doSearch function will be called with the query. For example, if the page URL is currently http://myapp.com/#searches/abc123, doSearch will be called with 'abc123'. If the page URL later becomes '#searches/sencha', doSearch is called again with 'sencha'.</p>\n\n<h4 id='upgrade_1_to_2-section-new-capabilities'>New Capabilities</h4>\n\n<p>In Sencha Touch 2 Controllers gained new capabilities, the most powerful of which are refs and control. For more information see the <a href=\"#!/guide/controllers\">controllers guide</a>.</p>\n\n<h2 id='upgrade_1_to_2-section-further-help'>Further Help</h2>\n\n<p>Once you have migrated everything you can and updated all of your code such that there are no more console warnings, your app should be mostly functional. For any specific problems the best place to get help is on the <a href=\"http://www.sencha.com/forum/forumdisplay.php?89-Sencha-Touch-2.x-Forums\">Sencha Touch 2 Forums</a>.</p>\n","title":"Migrating from Previous Sencha Touch Versions"});